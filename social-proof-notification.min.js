/**
 * SocialProofNotification.js
 * A lightweight library for displaying social proof notifications
 * Compatible with Bootstrap, Tailwind, and custom CSS frameworks
 * 
 * @version 1.0.0
 * @license MIT
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).SocialProofNotification=n()}(this,function(){"use strict";const t={position:"bottom-right",autoClose:!0,autoCloseTimeout:8e3,initialDelay:1e4,dataSource:"local",apiUrl:null,localData:[],saveToStorage:!0,minTimeBetween:9,theme:"default",showIcon:!0,iconType:"checkmark",animation:"slide",animationDuration:300,closeButton:!0,pauseOnHover:!1,maxNotifications:1,messageFormat:"{count} people {action} {timeframe}!"},n={default:{container:"spn-notification",wrapper:"spn-wrapper",iconWrapper:"spn-icon-wrapper",icon:"spn-icon",content:"spn-content",message:"spn-message",timestamp:"spn-timestamp",closeButton:"spn-close"},bootstrap:{container:"toast show",wrapper:"d-flex align-items-start gap-3 px-3 py-2",iconWrapper:"flex-shrink-0",icon:"bi bi-check-circle-fill text-success fs-4",content:"flex-grow-1",message:"mb-1 fw-semibold",timestamp:"text-muted small",closeButton:"btn-close ms-auto"},tailwind:{container:"bg-white border border-gray-200 rounded-lg shadow-lg p-4",wrapper:"flex items-start justify-between",iconWrapper:"flex-shrink-0",icon:"w-5 h-5 text-green-600",content:"flex-1 min-w-0 ml-3",message:"text-sm text-gray-600",timestamp:"text-xs text-gray-400 mt-1",closeButton:"flex-shrink-0 ml-2 text-gray-400 hover:text-gray-600 transition-colors"}},e=["bought this","joined the program","enrolled","got access","completed their purchase","signed up","started their journey","secured their spot"],i=["in the last hour","recently","X minutes ago","in the last X hours"],o=["Two","Three","Four","Five","Six","Seven","Eight"];class s{constructor(n={}){this.config={...t,...n},this.notificationElement=null,this.notificationsShown=0,this.timeoutId=null,this.isVisible=!1,this.storageKey="spn_last_shown",this.injectStyles()}init(){this.shouldShowNotification()&&setTimeout(()=>{this.show()},this.config.initialDelay)}injectStyles(){this.injectBaseStyles(),"default"===this.config.theme&&this.injectDefaultThemeStyles()}injectBaseStyles(){const t="spn-base-styles";if(document.getElementById(t))return;const n=document.createElement("style");n.id=t,n.textContent="\n        .spn-container {\n          position: fixed;\n          z-index: 9999;\n          max-width: 400px;\n        }\n\n        .spn-container.position-top-left { top: 20px; left: 20px; }\n        .spn-container.position-top-right { top: 20px; right: 20px; }\n        .spn-container.position-top-center { top: 20px; left: 50%; transform: translateX(-50%); }\n        .spn-container.position-bottom-left { bottom: 20px; left: 20px; }\n        .spn-container.position-bottom-right { bottom: 20px; right: 20px; }\n        .spn-container.position-bottom-center { bottom: 20px; left: 50%; transform: translateX(-50%); }\n\n        @media (max-width: 640px) {\n          .spn-container {\n            max-width: calc(100vw - 40px);\n            left: 20px !important;\n            right: 20px !important;\n            transform: none !important;\n          }\n        }\n      ",document.head.appendChild(n)}injectDefaultThemeStyles(){const t="spn-default-theme-styles";if(document.getElementById(t))return;const n=document.createElement("style");n.id=t,n.textContent="\n        .spn-container {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n        }\n\n        .spn-notification {\n          background: white;\n          border: 1px solid #e5e7eb;\n          border-radius: 8px;\n          box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\n          padding: 16px;\n          transition: all 0.3s ease-in-out;\n        }\n\n        .spn-notification.animate-slide {\n          animation: spn-slide-in 0.3s ease-out;\n        }\n\n        .spn-notification.animate-fade {\n          animation: spn-fade-in 0.3s ease-out;\n        }\n\n        .spn-notification.animate-bounce {\n          animation: spn-bounce-in 0.5s ease-out;\n        }\n\n        .spn-notification.hiding {\n          opacity: 0;\n          transform: translateX(100%);\n        }\n\n        .spn-wrapper {\n          display: flex;\n          align-items: flex-start;\n        }\n\n        .spn-icon-wrapper {\n          flex-shrink: 0;\n          margin-right: 12px;\n        }\n\n        .spn-icon-wrapper .spn-icon-circle {\n          width: 32px;\n          height: 32px;\n          background-color: #dcfce7;\n          border-radius: 50%;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n\n        .spn-icon {\n          width: 20px;\n          height: 20px;\n          color: #16a34a;\n        }\n\n        .spn-content {\n          flex: 1;\n          min-width: 0;\n        }\n\n        .spn-message {\n          color: #4b5563;\n          font-size: 14px;\n          line-height: 1.5;\n          margin: 0 0 4px 0;\n        }\n\n        .spn-timestamp {\n          color: #9ca3af;\n          font-size: 12px;\n          margin: 0;\n        }\n\n        .spn-close {\n          flex-shrink: 0;\n          margin-left: 12px;\n          background: none;\n          border: none;\n          color: #9ca3af;\n          cursor: pointer;\n          padding: 0;\n          width: 20px;\n          height: 20px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          transition: color 0.2s;\n        }\n\n        .spn-close:hover {\n          color: #4b5563;\n        }\n\n        .spn-close svg {\n          width: 16px;\n          height: 16px;\n        }\n\n        @keyframes spn-slide-in {\n          from {\n            opacity: 0;\n            transform: translateX(100%);\n          }\n          to {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n\n        @keyframes spn-fade-in {\n          from {\n            opacity: 0;\n          }\n          to {\n            opacity: 1;\n          }\n        }\n\n        @keyframes spn-bounce-in {\n          0% {\n            opacity: 0;\n            transform: scale(0.3) translateX(100%);\n          }\n          50% {\n            transform: scale(1.05) translateX(0);\n          }\n          70% {\n            transform: scale(0.9);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n      ",document.head.appendChild(n)}shouldShowNotification(){if(!this.config.saveToStorage)return!0;try{const t=localStorage.getItem(this.storageKey);if(!t)return!0;const n=new Date(t),e=new Date;return(e.getTime()-n.getTime())/36e5>=this.config.minTimeBetween}catch(t){return!0}}async fetchNotificationData(){if("local"===this.config.dataSource)return this.config.localData.length>0?this.config.localData[Math.floor(Math.random()*this.config.localData.length)]:this.generateRandomNotification();if("api"===this.config.dataSource&&this.config.apiUrl)try{const t=await fetch(this.config.apiUrl);return await t.json()}catch(t){return console.error("SocialProofNotification: Failed to fetch from API",t),this.generateRandomNotification()}return this.generateRandomNotification()}generateRandomNotification(){const t=e[Math.floor(Math.random()*e.length)];let n=i[Math.floor(Math.random()*i.length)];const s=o[Math.floor(Math.random()*o.length)];if(n.includes("X")){const t=Math.floor(8*Math.random())+2;n=n.replace("X",t.toString())}return{message:this.config.messageFormat.replace("{count}",s).replace("{action}",t).replace("{timeframe}",n),timestamp:"Just now"}}getIconSVG(){const t={checkmark:'<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>',fire:'<svg fill="currentColor" viewBox="0 0 24 24"><path d="M12 23a7.5 7.5 0 0 1-5.138-12.963C8.204 8.774 11.5 6.5 11 1.5c6 4 9 8 3 14 1 0 2.5 0 5-2.47.27.773.5 1.604.5 2.47A7.5 7.5 0 0 1 12 23z"></path></svg>',star:'<svg fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg>'};return t[this.config.iconType]||t.checkmark}getCloseButtonSVG(){return'<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>'}createNotificationElement(t){const e=n[this.config.theme]||n.default,i="bootstrap"===this.config.theme,o="tailwind"===this.config.theme,s=document.createElement("div");s.className=`spn-container position-${this.config.position}`;const a=document.createElement("div");a.className=e.container,"none"!==this.config.animation&&"default"===this.config.theme&&a.classList.add(`animate-${this.config.animation}`);const c=document.createElement("div");if(c.className=e.wrapper,this.config.showIcon){const t=document.createElement("div");if(t.className=e.iconWrapper,"default"===this.config.theme){const n=document.createElement("div");n.className="spn-icon-circle";const i=document.createElement("div");i.className=e.icon,i.innerHTML=this.getIconSVG(),n.appendChild(i),t.appendChild(n)}else if(i){const n=document.createElement("i");n.className=e.icon,n.style.fontSize="24px",t.appendChild(n)}else if(o){const t=document.createElement("div");t.className=`${e.iconWrapper} w-8 h-8 bg-green-100 rounded-full flex items-center justify-center`,t.innerHTML=`<div class="${e.icon}">${this.getIconSVG()}</div>`,c.appendChild(t)}o||c.appendChild(t)}const r=document.createElement("div");r.className=e.content;const l=document.createElement("p");if(l.className=e.message,l.textContent=t.message,r.appendChild(l),t.timestamp){const n=document.createElement("p");n.className=e.timestamp,n.textContent=t.timestamp,r.appendChild(n)}if(c.appendChild(r),this.config.closeButton){const t=document.createElement("button");t.className=e.closeButton,t.setAttribute("aria-label","Close notification"),i?t.setAttribute("type","button"):t.innerHTML=this.getCloseButtonSVG(),t.addEventListener("click",()=>this.hide()),c.appendChild(t)}return a.appendChild(c),s.appendChild(a),this.config.pauseOnHover&&(s.addEventListener("mouseenter",()=>{this.timeoutId&&clearTimeout(this.timeoutId)}),s.addEventListener("mouseleave",()=>{this.config.autoClose&&this.isVisible&&(this.timeoutId=setTimeout(()=>this.hide(),this.config.autoCloseTimeout))})),s}async show(){if(this.notificationsShown>=this.config.maxNotifications)return;if(this.isVisible)return;const t=await this.fetchNotificationData();if(this.notificationElement=this.createNotificationElement(t),document.body.appendChild(this.notificationElement),this.isVisible=!0,this.notificationsShown++,this.config.saveToStorage)try{localStorage.setItem(this.storageKey,(new Date).toISOString())}catch(t){console.warn("SocialProofNotification: Failed to save to localStorage",t)}this.config.autoClose&&(this.timeoutId=setTimeout(()=>this.hide(),this.config.autoCloseTimeout))}hide(){if(!this.notificationElement||!this.isVisible)return;const t=this.notificationElement.querySelector("default"===this.config.theme?".spn-notification":"bootstrap"===this.config.theme?".toast":'[class*="bg-white"]');t&&"default"===this.config.theme&&t.classList.add("hiding"),setTimeout(()=>{this.notificationElement&&this.notificationElement.parentNode&&this.notificationElement.parentNode.removeChild(this.notificationElement),this.notificationElement=null,this.isVisible=!1},this.config.animationDuration),this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}destroy(){this.hide(),this.notificationsShown=0}}return{create:function(t){return new s(t)},SocialProofNotification:s}});